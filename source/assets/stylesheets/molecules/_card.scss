/* ==========================================================================
// Card module
// -> A short listing pointing at more detailed content, like a chapter
//    or large table. Often found in 'feed' and 'gallery' organisms.
// ========================================================================== */

@import "../core/*";
@import "../atoms/media";
@import "../atoms/heading";

$card-break: 'small';
$card-thumb-w: 50%;

/* Base
// -------------------------------------------------------------------------- */

.card {
    @include clearfix;
    position: relative;
    display: block;
}

/*  Modifiers
// -------------------------------------------------------------------------- */

/* --- Layout --------------------------------------------------------------- */

// horizontal layout (2 columns, thumb on left)
.card.horizontal {
    font-size: 0; // fix whitespace issues with inline-block

    .flexbox & {
        @include respond-to($card-break) { display: flex; }
    }
}

/* --- Sizing --------------------------------------------------------------- */

// small version
// -> stays horizontal at mobile sizes when used with .horizontal modifier
.card.small {}

/* --- Appearance ----------------------------------------------------------- */

// "tile" card
// has a solid bg and full-bleed thumb
.card.tile {
    padding: $gutter;
    background-color: theme(well);

    .flexbox & { padding: 0; }
}

/* Submodules
// -------------------------------------------------------------------------- */

/* --- thumbnail image ------------------------------------------------------ */
.card-thumb {
    display: block;
    position: relative;
    overflow: hidden;
    vertical-align: top;
    border-bottom: 0;
    background-color: theme(text tertiary);

    &.stretch { width: 100%; }

    .card.horizontal & {
        @include respond-to($card-break) {
            display: inline-block;
            width: $card-thumb-w;
        }
    }

    .card.horizontal.small & {
        display: inline-block;
        width: $card-thumb-w;
    }

    .flexbox .card.horizontal.tile & {
        @include respond-to($card-break) {
            flex: 1;
            width: auto;
        }
    }

    img {
        // @include border(all, thin);

        .stretch > & { width: 100%; } // force the thumbnail image to be fill its container

        // imitate "background-size: cover" with img element
        .flexbox .card.horizontal.tile & {
            @include respond-to($card-break) {
                position: absolute;
                object-fit: cover;
                min-width: 100%;
                min-height: 100%;
            }
        }

        // center the image within its frame if transforms are supported
        .flexbox.csstransforms .card.horizontal.tile & {
            @include respond-to($card-break) {
                @include transform(translateY(-50%) translateX(-50%));
                top: 50%;
                left: 50%;
            }
        }
    }
}

/* --- content container ---------------------------------------------------- */
.card-content {

    // put the content in the right column in "horizontal" layouts
    @mixin col-right {
        display: inline-block;
        margin-top: 0;
        padding-left: $gutter;
        width: (100% - $card-thumb-w);
    }

    @include rem(font-size, 16px);
    display: block;
    vertical-align: top;

    .card-thumb + & { padding-top: $gutter; }

    .card.small .card-thumb + & { padding-top: 0.5em; }

    .card.tile & { padding: $gutter; }

    .card.horizontal & {
        @include respond-to($card-break) { @include col-right; }
    }

    .card.horizontal.small & { @include col-right; }

    .flexbox .card.tile & {
        @include respond-to($card-break) {
            flex: 1;
            padding: $gutter;
            width: auto;
        }
    }
}

.card-title {
    @extend %beta;
    @extend %base-transition;
    @include chapter_highlights;
    border-bottom: none;
    line-height: 1.1;

    @include respond-to('medium') { @include rem(font-size, 34px) }

    &:hover, &:active {
        color: theme(highlight);
    }

    .card.small & {
        @extend %font-accent;
        @extend %epsilon;
    }

    a { border-bottom: none; }
}

.card-subtitle {
    @extend %delta;
    @extend %base-transition;
    display: block;
    margin-top: 0.5em;

    .card.small & {
        @extend %font-accent--bold;
        font-size: fs(2);
        line-height: 1.2;
        // text-transform: uppercase;
        color: theme(text tertiary);
    }
}
